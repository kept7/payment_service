### How to start

Склонируйте репозиторий проекта:

```bash
git clone https://github.com/kept7/payment_service.git
```

Откройте папку с проектом, создайте файл `.env` и заполните его (пример переменных см. `.env.example`).

Затем выполните:

```bash
docker-compose up --build
```

---

### How to use

Документация доступна по адресу:

- http://localhost:8000/docs  
- http://127.0.0.1:8000/docs

Изначально неавторизованный пользователь имеет доступ только к двум endpoint'ам:

- `/auth/registration` — регистрация  
- `/auth/authentication` — аутентификация

Если у вас нет аккаунта — зарегистрируйтесь, затем авторизуйтесь. При успешной авторизации в cookie браузера будет храниться JWT-токен в течение ограниченного времени.

После авторизации доступны следующие операции:

- Изменить пароль — `PUT /auth/{user_email}`
- Создать платёж — `POST /payment`
- Получить информацию о конкретном платеже — `GET /payment/{payment_id}`
- Получить информацию обо всех своих платежах — `GET /payment/{user_email}/all`
- Получить информацию о всех платежах с определённым статусом — `GET /payment/{user_email}/{status}`
- Получить информацию о всех платежах меньше определённой суммы — `GET /payment/{user_email}/{amount}`
- Обновить статус конкретного платежа (если он не завершён) — `PUT /payment/{payment_id}`

---

### SuperUser

Чтобы воспользоваться endpoint'ами суперпользователя:

1. В `.env` укажите email суперпользователя (переменная, напр., `SUPERUSER_EMAIL` — см. `.env.example`).
2. Зарегистрируйтесь под этим email и авторизуйтесь.

Доступные суперпользователю endpoint'ы:

- Получение данных о всех зарегистрированных пользователях — `GET /auth/all`
- Получение информации о всех платежах — `GET /payment/all`
- Получение информации о всех платежах пользователей (админский) — `GET /admin/user_payment/all`

---

### About project

- Стек: **Python 3.13**, **FastAPI**, **Pydantic**, **PostgreSQL**, **SQLAlchemy**
- Тесты: функции покрыты unit-тестами
- Миграции: поддерживается миграция с помощью **Alembic**
- Логирование: реализовано логирование, а также возможность просмотра логов через `docker logs`.\
Чтобы этим воспользоваться выполните команду в консоле `docker logs -f task-web-1`.

---